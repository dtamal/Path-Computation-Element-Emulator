<!DOCTYPE html>
<html lang="en" ng-app = "pceeApp">
  <head>
    <meta name="generator"
    content="HTML Tidy for HTML5 (experimental) for Windows https://github.com/w3c/tidy-html5/tree/c63cc39" />
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <link rel="shortcut icon" href="../../assets/ico/favicon.ico" />
    <title>PCEE</title>
    <!-- Bootstrap -->
    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <!-- Custom styles for this template -->
    <link href="css/sticky-footer-navbar.css" rel="stylesheet" />
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script type="text/javascript" src="js/script.js"></script>
  </head>
  <body>
  <!-- Fixed navbar -->
  <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
		<span class="icon-bar"></span>
        <span class="icon-bar"></span>
		<span class="icon-bar"></span>
      </button> 
      <a class="navbar-brand" href="#">Path Computation Element Emulator</a></div>
      <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav">
          <li class="active">
            <a href="#">Home</a></li>
			<li><a href="#about">About</a></li>
        </ul>
      </div>
      <!--/.nav-collapse -->
    </div>
  </div>
  <!-- Begin page content -->
  
  <div class="container">

      <h1>PCE Client</h1>

	<div class="jumbotron">
    	<div style="margin-left: 2em">
      	<h2>Client log</h2>
			<div ng-controller="logCtrl">
				<div ng-repeat="logEntry in log" ng-bind-html="logEntry.html"></div> 
    	 	 	<p><a class="btn btn-primary" id="clearButton2" onclick="window.oldLogs = [];" role="button">Clear</a>
			</div>
    	</div>
	</div>
  </div>
  <div id="footer">
    <div class="container">
      <p class="text-muted">Path Computation Element Emulator</p>
    </div>
  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> 
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="bootstrap/js/bootstrap.min.js"></script>
  <script src="js/angular.min.js"></script>
  <script src="js/angular-sanitize.min.js"></script>
  <script type="text/javascript">

  window.oldLogs = [];

  angular.module('pceeApp', ['ngSanitize'])

  .controller('logCtrl', ['$scope', '$http', '$timeout', function logCtrl($scope, $http, $timeout) {
      $scope.log=[];   
      
	  (function getLogs() {
            $http.get('http://localhost:8081/ctrl/logs').
            success(function(data) {
		    	for (var i=0;i<data.length;i++) {
      				var index = oldLogs.length;
      				oldLogs[index] = {};
      				oldLogs[index] = data[i];
      			}
		    	var out = [];
		    	var logCount = 50;
		    	for (var i=oldLogs.length-1;i>=0;i--) {
		            out[i] = {}; 
		    		out[i].html = '<p>[' + oldLogs[i].level + '] ' + oldLogs[i].message + '</p>'; 
		    		logCount--;
		    		if (logCount==0)
		    			break;
		      	}
		        $scope.log=out;    	  		    	
		    	$timeout(getLogs, 2000);
            });
      	})();
  }]);
</script>
  
  </body>
</html>
